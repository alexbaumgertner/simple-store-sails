block('cart')(
    def()(function() {
        var cart = this.ctx.data.cart,
            items = [];

        cart.items.forEach(function(item, index) {
            items.push({
                elem: 'item',
                tag: 'tr',
                content: [
                    {
                        elem: 'product',
                        tag: 'td',
                        content: [
                            {
                                block: 'image',
                                width: '100px',
                                url: item.image,
                                title: item.title,
                                alt: item.title
                            },
                            {
                                content: item.header + ' / ' +  item.theme
                            }
                        ]
                    },
                    {
                        elem: 'price',
                        tag: 'td',
                        content: item.price
                    },
                    {
                        elem: 'quantity',
                        tag: 'td',
                        content: item.quantity
                    },
                    {
                        elem: 'summary',
                        tag: 'td',
                        content: item.price * item.quantity
                    }
                ]
            });
        });

        return applyCtx({
            block: 'cart',
            tag: 'table',
            content: [
                {
                    elem: 'head',
                    tag: 'thead',
                    content: [
                        {
                            tag: 'tr',
                            content: [
                                {
                                    tag: 'th',
                                    content: 'Наименование товара'
                                },
                                {
                                    tag: 'th',
                                    content: 'Цена'
                                },
                                {
                                    tag: 'th',
                                    content: 'Количество'
                                },
                                {
                                    tag: 'th',
                                    content: 'Итого'
                                }
                            ]
                        }
                    ]
                },
                {
                    elem: 'items',
                    tag: 'tbody',
                    content: items
                }
            ]
        });
    })
);
